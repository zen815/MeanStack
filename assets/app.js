angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(t){t.$on("login",function(n,o){t.currentUser=o})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(t,n){t.login=function(o,e){n.login(o,e).then(function(n){t.$emit("login",n.data)})},console.log("login.ctrl.js end")}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(t,n){t.addPost=function(){t.postBody&&n.create({body:t.postBody}).then(function(){t.postBody=null})},t.$on("ws:new_post",function(n,o){t.$apply(function(){t.posts.unshift(o)})}),n.fetch().then(function(n){t.posts=n})}]),angular.module("app").service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts").then(function(t){return t.data})},this.create=function(n){return t.post("/api/posts",n)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","$location",function(t,n,o){t.register=function(e,r){n.register(e,r).then(function(n){t.$emit("login",n),o.path("/")})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"/posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/login.html"})}]),angular.module("app").service("UserSvc",["$http",function(t){var n=this;n.getUser=function(){return t.get("/api/users")},n.login=function(o,e){return t.post("/api/sessions",{username:o,password:e}).then(function(o){return n.token=o.data,t.defaults.headers.common["x-auth"]=o.data,n.getUser()})},n.register=function(o,e){return t.post("/api/users",{username:o,password:e}).then(function(){return n.login(o,e)})}}]),angular.module("app").service("WebSocketSvc",["$rootScope","$window",function(t,n){function o(){return"https:"===n.location.protocol?"wss://"+window.location.host:"ws://"+window.location.host}var e=null;this.connect=function(){e=new WebSocket(o()),e.onmessage=function(n){console.log(n);var o=JSON.parse(n.data);t.$broadcast("ws:"+o.topic,o.data)}},this.send=function(t,n){var o=JSON.stringify({topic:t,data:n});e.send(o)}}]).run(["WebSocketSvc",function(t){t.connect()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkb24iLCJfIiwidXNlciIsImN1cnJlbnRVc2VyIiwiVXNlclN2YyIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJwb3N0IiwiJGFwcGx5IiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwiJGxvY2F0aW9uIiwicmVnaXN0ZXIiLCJwYXRoIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJnZXRVc2VyIiwidmFsIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCIkcm9vdFNjb3BlIiwiJHdpbmRvdyIsIndlYnNvY2tldEhvc3QiLCJsb2NhdGlvbiIsInByb3RvY29sIiwid2luZG93IiwiaG9zdCIsImNvbm5lY3Rpb24iLCJjb25uZWN0IiwiV2ViU29ja2V0Iiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsInJ1biIsIldlYlNvY2tldFN2YyJdLCJtYXBwaW5ncyI6IkFBR0FBLFFBQUFDLE9BQUEsT0FDQSxZQ0RBRCxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsbUJBQUEsU0FBQSxTQUFBQyxHQUNB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QUFBQSxFQUFBL0MsS0FBQUEsR0FDQXNDLEdBQUFVLEtBQUFDLE9BR0FFLEtBQUEsZUFBQSxTQUFBQyxHQUNBQSxFQUFBYiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgemVuIG9uIDE1LiA3LiAxMC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAnbmdSb3V0ZSdcbl0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB6ZW4gb24gMTUuIDcuIDE4LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sdXNlcikge1xuICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgIH0pXG59KTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgemVuIG9uIDE1LiA3LiAxNy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjKXtcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgVXNlclN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZygnbG9naW4uY3RybC5qcyBlbmQnKTtcbn0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB6ZW4gb24gMTUuIDcuIDEwLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFBvc3RzU3ZjKXtcbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZigkc2NvcGUucG9zdEJvZHkpe1xuICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICRzY29wZS5wb3N0Qm9keSA9IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3Qpe1xuICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcbiAgICAgICAgfSlcbiAgICB9KTtcblxuICAgIFBvc3RzU3ZjLmZldGNoKCkudGhlbihmdW5jdGlvbihwb3N0cyl7XG4gICAgICAgICRzY29wZS5wb3N0cyA9IHBvc3RzO1xuICAgIH0pO1xufSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHplbiBvbiAxNS4gNy4gMTAuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXG4gICAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHBvc3QpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KTtcbiAgICB9O1xufSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHplbiBvbiAxNS4gNy4gMTkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclN2YywgJGxvY2F0aW9uKXtcbiAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgICAgVXNlclN2Yy5yZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKTtcbiAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgIH0pO1xuICAgfVxufSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHplbiBvbiAxNS4gNy4gMTQuXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKXtcbiAgICAkcm91dGVQcm92aWRlclxuICAgIC53aGVuKCcvJywgICAgICAgICAgeyBjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgICAgdGVtcGxhdGVVcmw6ICcvcG9zdHMuaHRtbCd9IClcbiAgICAud2hlbignL3JlZ2lzdGVyJywgIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3JlZ2lzdGVyLmh0bWwnfSlcbiAgICAud2hlbignL2xvZ2luJywgICAgIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsICAgIHRlbXBsYXRlVXJsOiAnL2xvZ2luLmh0bWwnfSlcbn0pO1xuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgemVuIG9uIDE1LiA3LiAxNy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uKCRodHRwKXtcbiAgICB2YXIgc3ZjID0gdGhpcztcbiAgICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJyk7XG4gICAgfVxuXG4gICAgc3ZjLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgICAgICBzdmMudG9rZW4gPSB2YWwuZGF0YTtcbiAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXSA9IHZhbC5kYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHN2Yy5nZXRVc2VyKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpO1xuICAgICAgICB9KVxuICAgIH1cbn0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB6ZW4gb24gMTUuIDcuIDIyLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdXZWJTb2NrZXRTdmMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkd2luZG93KXtcbiAgICBmdW5jdGlvbiB3ZWJzb2NrZXRIb3N0KCkge1xuICAgICAgICBpZigkd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSBcImh0dHBzOlwiKXtcbiAgICAgICAgICAgIHJldHVybiBcIndzczovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJ3czovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29ubmVjdGlvbiA9IG51bGw7XG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAwMCc7XG4gICAgICAgIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHdlYnNvY2tldEhvc3QoKSk7XG5cbiAgICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50b3BpYywgcGF5bG9hZC5kYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uKHRvcGljLCBkYXRhKSB7XG4gICAgICAgIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkoe3RvcGljOiB0b3BpYywgZGF0YTogZGF0YX0pO1xuICAgICAgICBjb25uZWN0aW9uLnNlbmQoanNvbik7XG4gICAgfVxufSlcbi5ydW4oZnVuY3Rpb24oV2ViU29ja2V0U3ZjKXtcbiAgICBXZWJTb2NrZXRTdmMuY29ubmVjdCgpO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9